{% extends 'base.html' %}

{% block content %}
    
    <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
        <div>
            <h2 class="text-2xl font-bold text-gray-800">Twoja Lod√≥wka</h2>
            <p class="text-gray-500 text-sm">ZarzƒÖdzaj swoimi zapasami.</p>
        </div>
        
        <a href="{{ url_for('tagi') }}" class="sm:hidden w-full text-center bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-50 transition">
            tagi
        </a>
    </div>

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        
        {% if produkty %}
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="bg-gray-50 text-gray-500 text-xs uppercase tracking-wider border-b border-gray-200">
                        <th class="p-4 font-semibold">Produkt</th>
                        <th class="p-4 font-semibold">Ilo≈õƒá</th>
                        <th class="p-4 font-semibold">Tagi</th>
                        <th class="p-4 font-semibold text-right">Akcje</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-100">
                    {% for p in produkty %}
                    <tr class="hover:bg-gray-50 transition-colors group">

                        <td class="p-4 font-medium text-gray-800">
                            {{ p.name }}
                            {% if p.isFrozen %}
                                <span class="text-xs ml-2 text-cyan-600 bg-cyan-50 px-2 py-0.5 rounded border border-cyan-100" title="Zamro≈ºone">‚ùÑÔ∏è Mro≈ºone</span>
                            {% endif %}
                        </td>
                        <td class="p-4 text-gray-600">
                            <span class="font-bold text-gray-800">{{ p.ilosc }}</span> {{ p.jednostka }}
                        </td>

                        <td class="p-4">
    <div class="flex flex-wrap gap-2">
        {% for tag in p.tags %}
        <form action="{{ url_for('usun_tag') }}"
              method="post"
              class="inline-flex items-center bg-green-100 text-green-800 text-xs rounded px-2 py-1 gap-1">

            <span>#{{ tag }}</span>

            <input type="hidden" name="produkt_id" value="{{ p.id }}">
            <input type="hidden" name="tag" value="{{ tag }}">

            <button type="submit"
                    class="ml-1 text-green-700 hover:text-red-600 font-bold leading-none">
                √ó
            </button>
        </form>
        {% endfor %}
    </div>
</td>




                        <td class="p-4 whitespace-nowrap text-right">
                         <form action="{{ url_for('dodaj_tag') }}"
          method="post"
          class="flex justify-end items-center gap-2">

        <input type="hidden" name="produkt_id" value="{{ p.id }}">

        <input type="text"
               name="tag"
               placeholder="tag..."
               class="hidden group-hover:block text-sm border border-gray-300 rounded px-2 py-1 w-24
                      focus:outline-none focus:ring-1 focus:ring-green-500">

        <button type="submit"
                class="inline-flex items-center gap-1 text-sm bg-white border border-gray-300 text-gray-700
                       px-3 py-1 rounded hover:bg-green-50 hover:text-green-700 hover:border-green-300 transition">
            <span class="text-green-600 font-bold">#</span> Dodaj
        </button>
    </form>
</td>




                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        {% else %}
            <div class="text-center py-16">
                <div class="text-6xl mb-4">üì≠</div>
                <h3 class="text-xl font-medium text-gray-900">Twoja lod√≥wka jest pusta</h3>
                <p class="text-gray-500 mt-1 mb-6">Dodaj pierwsze produkty, aby zaczƒÖƒá kontrolowaƒá terminy.</p>
                <a href="{{ url_for('dodaj_produkt') }}" class="bg-green-600 text-white px-6 py-3 rounded-full hover:bg-green-700 shadow transition">
                    + Dodaj pierwszy produkt
                </a>
            </div>
        {% endif %}

    </div>

{% endblock %}